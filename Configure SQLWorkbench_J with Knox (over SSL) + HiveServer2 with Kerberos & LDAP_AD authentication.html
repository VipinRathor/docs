<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.5.2 (457164)"/><meta name="author" content="Vipin Rathor"/><meta name="created" content="2018-08-18 02:41:30 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-09-06 23:00:49 +0000"/><title>Configure SQLWorkbench/J with Knox (over SSL) + HiveServer2 with Kerberos &amp; LDAP/AD authentication</title></head><body><div>Note1 - SQLWorkbench/J will be referred to as “WB” (short of WorkBench) in the rest of this document</div><div>Note2 - Always test connection string with Beeline first to make sure that it is actually working</div><div><br/></div><ol><li><div>Pre-Configurations</div></li><ol><li><div>HiveServer2 (HS2) in HTTP mode (binary mode is used only for testing)</div></li><li><div>Knox with Kerberos authentication</div></li><li><div>hadoop.proxyuser.knox in core-site.xml</div></li><li><div>Kerberos client configs on MacOS</div><div>In /etc/krb5.conf :</div><div>  [libdefaults]</div><div>  default_cc_type = FILE</div><div>  default_ccache_name = FILE:/tmp/krb5cc_%{uid}</div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/C58393A2-DACB-420F-90B4-BC4AE51ACB38.png" height="731" width="870"/></div></li><li><div>Kerberos client configs on Windows</div><div>Windows client should be part of the AD Domain Controller. WB is capable of using Windows credential (LSA) directly.</div><div>Login as AD user (DOMAIN\&lt;username&gt;), example : LAB.HORTONWORKS.NET\hr1</div><div><br/></div><div>Things which are <b>NOT</b> required:</div><div>- MIT Kerberos client for Windows</div><div>- krb5.ini</div><div>- any JAAS config file</div><div><br/></div></li><li><div><span style="color: rgb(6, 5, 9);">Download and configure WB for Hive JDBC connection</span></div><div><span style="color: rgb(6, 5, 9);">Download link: <a href="https://www.sql-workbench.eu/downloads.html" style="color: rgb(6, 5, 9);">https://www.sql-workbench.eu/downloads.html</a></span></div><div><span style="color: rgb(6, 5, 9);">Configure WB with Hive Driver: <a href="https://www.simba.com/blog/connecting-sql-workbench-j-to-hive-data/" style="color: rgb(6, 5, 9);">https://www.simba.com/blog/connecting-sql-workbench-j-to-hive-data/</a></span></div><div><br/></div></li></ol><li><div>Configure WB directly with HS2 in binary mode + Kerberos</div><div><span style="font-weight: bold;">jdbc:hive2://bali2.openstacklocal:10000;AuthMech=1;KrbAuthType=2;KrbServiceName=hive;KrbHostFQDN=bali2.openstacklocal;KrbRealm=LAB.HORTONWORS.NET</span></div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/EAD9125F-0A1C-4ADF-A55C-FC234D644654.png" height="655" width="1452"/></div><div><br/></div></li></ol><ol start="3"><li><div>Configure WB with HS2 in HTTP mode + Kerberos</div><div>Beeline connection string:</div><div><span style="font-weight: bold;">beeline -u "jdbc:hive2://foo2.openstacklocal:10001/default;httpPath=cliservice;transportMode=http;principal=hive/_HOST@FOOBAR.COM;"</span></div><div><br/></div><div>WB Connection String:</div><div><span style="font-weight: bold;">jdbc:hive2://foo2.openstacklocal:10001;AuthMech=1;KrbServiceName=hive;KrbHostFQDN=foo2.openstacklocal;KrbRealm=FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=cliservice</span></div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/93912047-6F11-4FA0-8108-9C8DE277BBA6.png" height="655" width="1452"/></div><div><br/></div></li><li><div>Configure WB with Knox (over SSL) with Kerberos authentication + HS2 in HTTP mode + Kerberos</div><div>Beeline Connection String:</div><div><span style="font-weight: bold;">beeline -u "jdbc:hive2://foo3.openstacklocal:8443/;transportMode=http;httpPath=gateway/default/hive;ssl=true;sslTrustStore=/root/knox.jks;trustStorePassword=hadoop;principal=HTTP/foo3.openstacklocal@FOOBAR.COM"</span></div><div><br/></div><div>WB Connection String:</div><div><span style="font-weight: bold;">jdbc:hive2://foo3.openstacklocal:8443/;</span><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">AuthMech=1;KrbServiceName=HTTP;KrbHostFQDN=foo3.openstacklocal;KrbRealm=FOOBAR.COM;KrbAuthType=2;</span><span style="font-weight: bold;">transportMode=http;httpPath=gateway/default/hive;SSL=1;SSLTrustStore=/Users/vrathor/Downloads/knox.jks;SSLTrustStorePwd=hadoop;AllowSelfSignedCerts=1</span></div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/17084A76-C713-4445-BE0A-B9030CBCB438.png" height="656" width="1448"/></div><div><br/></div></li><li><div>Configure WB with Knox (over SSL) with LDAP/AD authentication + HS2 in HTTP mode + Kerberos</div><div>Beeline Connection String:</div><div><span style="font-weight: bold;">beeline -u "jdbc:hive2://foo3.openstacklocal:8443/;transportMode=http;httpPath=gateway/default/hive;ssl=true;sslTrustStore=/root/knox.jks;trustStorePassword=hadoop;” -n hr1 -p BadPass#1</span></div><div><br/></div><div>WB Connection String:</div><div><span style="font-weight: bold;">jdbc:hive2://foo3.openstacklocal:8443/;</span><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">AuthMech=2</span><span style="font-weight: bold;">;transportMode=http;httpPath=gateway/default/hive;SSL=1;SSLTrustStore=/Users/vrathor/Downloads/knox.jks;SSLTrustStorePwd=hadoop;AllowSelfSignedCerts=1</span></div><div><br/></div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/F0B2499F-DBD5-4FD2-8C85-00A576977E0F.png" height="655" width="1450"/></div><div><br/></div></li><li><div>Configuring WB with HS2 in HTTP mode + Kerberos + On Windows 10</div><div><br/></div><div>WB Connection String: (Same as on MacOS)</div><div><span style="font-weight: bold;">jdbc:hive2://foo2.openstacklocal:10001;AuthMech=1;KrbServiceName=hive;KrbHostFQDN=foo2.openstacklocal;KrbRealm=FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=cliservice</span></div><div><span style="font-weight: bold;"><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/VirtualBox_mugdha_06_09_2018_15_20_04.png" height="935" width="1680"/></span></div><div><br/></div></li><li><div>Troubleshooting</div></li><ol><li><div>How to enable debug for -</div></li><ol><li><div>WB</div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/FFCF0856-376D-4FA4-9975-0BA5BF43FD0A.png" height="838" width="956"/></div><div><br/></div></li><li><div>Run WB in console mode (very useful for checking Kerberos / SSL errors)</div><div>$ java -Djavax.net.debug=ssl -Dsun.security.krb5.debug=true -Dsun.security.jgss.debug=true -jar  /Users/vrathor/Downloads/<span style="font-weight: bold;">SQLWorkbenchJ.app/Contents/Java/sqlworkbench.jar</span> <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">-profile=knox-foo-HS2-krbtgt</span></div><div><br/></div></li><li><div>Kerberos</div><div>Use <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">-Dsun.security.krb5.debug=true</span> liberally at any level (WB / Knox / HS2)</div><div><br/></div></li><li><div>Kerberos on Windows</div><div>Invoke WB application from cmd line prompt:</div><div>&gt; java -Dsun.security.krb5.debug=true -Dsun.security.jgss.debug=true -jar C:\ProgramFiles\SQLWorkbench\sqlworkbench.jar -profile=hive</div><div><br/></div></li><li><div>SSL</div><div>Use <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">-Djavax.net.debug=ssl</span> at WB / Knox to figure out SSL handshake issue and/or certificate error</div><div><br/></div></li><li><div>Knox</div><div>In gateway-log4j.properties:</div><div>log4j.rootLogger=ERROR, drfa</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">log4j.logger.org.apache.hadoop.gateway=DEBUG</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">log4j.logger.org.apache.hadoop.security=TRACE</span></div><div><br/></div></li><li><div>HS2</div><div>In "hive-env template” under “Advanced hive-env":</div><div><br/></div><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/A184D5A4-6F25-4567-A290-FBB8F94EC1C0.png" height="72" width="979"/></div><div><br/></div><div>[[ For copy/paste ]]</div><div><font face="HelveticaNeue" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="font-size: 12px; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 250, 165); font-family: HelveticaNeue; color: rgb(0, 0, 0); font-variant-caps: normal;-evernote-highlight:true;">    </span><span style="letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="background-color: rgb(255, 250, 165); font-size: 14px; font-family: HelveticaNeue; color: rgb(0, 0, 0); font-variant-caps: normal;-evernote-highlight:true;">  if [ "$SERVICE" = "hiveserver2" ]; then</span></span></font></div><div><span style="letter-spacing: normal;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 14px; color: rgb(0, 0, 0); font-family: HelveticaNeue; font-variant-caps: normal;-evernote-highlight:true;">          export HIVE_OPTS="$HIVE_OPTS --hiveconf hive.root.logger=DEBUG,DRFA"</span></span></div><div><span style="letter-spacing: normal;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 14px; color: rgb(0, 0, 0); font-family: HelveticaNeue; font-variant-caps: normal;-evernote-highlight:true;">      fi</span></span></div><div><br/></div></li></ol></ol><li><div>Errors encountered along the way &amp; their fixes:</div></li></ol><div><br/></div><ul><li><div>WB can’t detect &amp; use correct Kerberos credentials from MacOS:</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: MacOS stores Kerberos credentials in keyring by default</span></span></div></li><li><div><span style="list-style: none;">Fix: Follow #1.4 and force MacOS to store credentials in FILE</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2017-04-26 17:42:36 ERROR Error connecting to the database using URL=jdbc:hive2://bali2.openstacklocal:10000;AuthMech=1;KrbRealm=</span>LAB.HORTONWORS.NET;KrbHostFQDN=bali3.openstacklocal; <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">KrbServiceName=hive;KrbAuthType=2, username= [Simba][HiveJDBCDriver](500168) Error creating login context using ticket cache: Unable to obtain Principal Name for authentication . [SQL State=HY000, DB Errorcode=500168]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">java.sql.SQLException: [Simba][HiveJDBCDriver](500168) Error creating login context using ticket cache: Unable to obtain Principal Name for authentication .</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HiveServer2ClientFactory.createTransport(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: com.simba.hiveserver2.support.exceptions.GeneralException: [Simba][HiveJDBCDriver](500168) Error creating login context using ticket cache: Unable to obtain Principal Name for authentication .</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 9 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: javax.security.auth.login.LoginException: Unable to obtain Principal Name for authentication</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.sun.security.auth.module.Krb5LoginModule.promptForName(Krb5LoginModule.java:841)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:704)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.sun.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:617)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at java.lang.reflect.Method.invoke(Method.java:498)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.login.LoginContext.invoke(LoginContext.java:755)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.login.LoginContext.access$000(LoginContext.java:195)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:682)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:680)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at java.security.AccessController.doPrivileged(Native Method)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.login.LoginContext.login(LoginContext.java:587)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.kerberos.Kerberos.getSubjectViaTicketCache(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HiveServer2ClientFactory.createTransport(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector$1.run(ConnectionSelector.java:131" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector$1.run(ConnectionSelector.java:131</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div></div><div><br/></div><ul><li><div>WB can’t detect &amp; use correct Kerberos credentials from MacOS:</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: No JCE support to use AES256 encryption algorithm in JDK (can ONLY be seen when WB is run in console mode)</span></span></div></li><li><div><span style="list-style: none;">Fix: Download &amp; install JCE policy JARs in JDK location (example location on my MacBook - /Library/Java/JavaVirtualMachines/jdk1.8.0_65.jdk/Contents/Home/jre/lib/security/ )</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">$ java</span> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">-Dsun.security.krb5.debug=true -jar  /Users/vrathor//Downloads/SQLWorkbenchJ.app/Contents/Java/sqlworkbench.jar -profile=knox-foo-HS2-krbtgt</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;KinitOptions cache name is /tmp/krb5cc_501</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt;  client principal is</span> <a href="mailto:hr1@LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">hr1@LAB.HORTONWORKS.NET</a></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Java config name: null</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Native config name: /etc/krb5.conf</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Loaded from native config</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; server principal is X-CACHECONF:/krb5_ccache_conf_data/fast_avail/krbtgt/</span><a href="mailto:LAB.HORTONWORKS.NET@LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">LAB.HORTONWORKS.NET@LAB.HORTONWORKS.NET</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">@</span><a href="http://LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">LAB.HORTONWORKS.NET</a></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; key type: 0</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; auth time: Fri Aug 17 18:06:40 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; start time: null</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; end time: Fri Aug 17 18:06:40 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; renew_till time: null</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt; CCacheInputStream: readFlags()</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt;  client principal is</span> <a href="mailto:hr1@LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">hr1@LAB.HORTONWORKS.NET</a></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; server principal is krbtgt/</span><a href="mailto:LAB.HORTONWORKS.NET@LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">LAB.HORTONWORKS.NET@LAB.HORTONWORKS.NET</a></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; key type: 18</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; auth time: Fri Aug 17 18:06:43 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; start time: Fri Aug 17 18:06:43 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; end time: Sat Aug 18 04:06:43 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; renew_till time: Fri Aug 24 18:06:42 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt; CCacheInputStream: readFlags()  FORWARDABLE; RENEWABLE; INITIAL; PRE_AUTH;</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt;  client principal is</span> <a href="mailto:hr1@LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">hr1@LAB.HORTONWORKS.NET</a></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; server principal is X-CACHECONF:/krb5_ccache_conf_data/negative-cache/host/</span><a href="mailto:west.exch080.serverdata.net@LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">west.exch080.serverdata.net@LAB.HORTONWORKS.NET</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">@</span><a href="http://LAB.HORTONWORKS.NET" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">LAB.HORTONWORKS.NET</a></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; key type: 0</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; auth time: Fri Aug 17 18:47:29 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; start time: null</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; end time: Fri Aug 17 18:47:29 PDT 2018</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt;DEBUG &lt;CCacheInputStream&gt; renew_till time: null</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt; CCacheInputStream: readFlags()</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt; KrbCreds found the default ticket granting ticket in credential cache.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt; <b>unsupported key type found the default TGT: 18</b></span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt; Acquire default native Credentials</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Using builtin default etypes for default_tkt_enctypes</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">default etypes for default_tkt_enctypes: 17 16 23.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">&gt;&gt;&gt; Found no TGT's in LSA</span></div></div><div><br/></div><ul><li><div>Kerberos GSS initiate failed</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: Hostname mismatch in connection string</span></span></div></li><li><div><span style="list-style: none;">Fix: Use same hostname for KrbHostFQDN</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-17 16:53:19 ERROR DbDriver.connect() Error connecting to the database using URL=jdbc:hive2://<b>bali2.openstacklocal</b>:10000;AuthMech=1;KrbRealm=</span>LAB.HORTONWORS.NET;KrbHostFQDN=<b>bali3.openstacklocal</b>; <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">KrbServiceName=hive, username= [Simba][HiveJDBCDriver](500164) Error initialized or created transport for authentication: [Simba][HiveJDBCDriver](500169) Unable to connect to server: Peer indicated failure: GSS initiate failed. [SQL State=HY000, DB Errorcode=500164]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">java.sql.SQLException: [Simba][HiveJDBCDriver](500164) Error initialized or created transport for authentication: [Simba][HiveJDBCDriver](500169) Unable to connect to server: Peer indicated failure: GSS initiate failed.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HiveServer2ClientFactory.createTransport(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: com.simba.hiveserver2.support.exceptions.GeneralException: [Simba][HiveJDBCDriver](500164) Error initialized or created transport for authentication: [Simba][HiveJDBCDriver](500169) Unable to connect to server: Peer indicated failure: GSS initiate failed.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 9 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: java.lang.RuntimeException: [Simba][HiveJDBCDriver](500169) Unable to connect to server: Peer indicated failure: GSS initiate failed</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HiveServerPrivilegedAction.run(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at java.security.AccessController.doPrivileged(Native Method)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at javax.security.auth.Subject.doAs(Subject.java:360)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HiveServer2ClientFactory.createTransport(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector$1.run(ConnectionSelector.java:131" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector$1.run(ConnectionSelector.java:131</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.thrift.transport.TTransportException: Peer indicated failure: GSS initiate failed</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.TSaslTransport.receiveSaslMessage(TSaslTransport.java:190)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.TSaslTransport.open(TSaslTransport.java:258)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.TSaslClientTransport.open(TSaslClientTransport.java:37)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 13 more</span></div></div><div><br/></div><ul><li><div>Open Session error and 401:</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: Old HDP JDBC driver could connect to HS2 in binary mode but not in HTTP mode (strange!)</span></span></div></li><li><div><span style="list-style: none;">Fix: Upgrading driver version from Simba_HiveJDBC41_1.0.36.1046 to Simba_HiveJDBC41_1.0.42.1054 did the trick!</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-17 18:01:02 ERROR DbDriver.connect() Error connecting to the database using URL=jdbc:hive2://foo2.openstacklocal:10001;AuthMech=3;KrbServiceName=hive;KrbHostFQDN=foo2.openstacklocal;KrbRealm=</span>FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=cliservice<span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">, username=hr1 [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error. [SQL State=HY000, DB Errorcode=500151]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">java.sql.SQLException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: com.simba.hiveserver2.support.exceptions.GeneralException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 10 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.thrift.transport.TTransportException: HTTP Response code: 401</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flushUsingHttpClient(THttpClient.java:246)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flush(THttpClient.java:297)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:65)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.send_OpenSession(TCLIService.java:153)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.send_OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:145)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.gui.profiles.ConnectionGuiHelper$1.run(ConnectionGuiHelper.java:142)</span></div></div><div><br/></div><ul><li><div>No SSL connection config provided while connecting to Knox:</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: No SSL connection config provided while connecting to Knox</span></span></div></li><li><div><span style="list-style: none;">Fix: Use SSL connection config as shown in the #4 at the beginning</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-17 18:17:39 ERROR DbDriver.connect() Error connecting to the database using URL=jdbc:hive2://foo3.openstacklocal:8443/;AuthMech=1;KrbServiceName=HTTP;KrbHostFQDN=foo2.openstacklocal;KrbRealm=</span>FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=gateway/default/hive<span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">, username= [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error. [SQL State=HY000, DB Errorcode=500151]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">java.sql.SQLException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.establishConnection(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.core.LoginTimeoutConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: com.simba.hiveserver2.support.exceptions.GeneralException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 11 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.thrift.transport.TTransportException: org.apache.http.NoHttpResponseException: The target server failed to respond</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flushUsingHttpClient(THttpClient.java:281)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flush(THttpClient.java:297)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:65)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.send_OpenSession(TCLIService.java:153)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.send_OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:145)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.establishConnection(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.core.LoginTimeoutConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.gui.profiles.ConnectionGuiHelper$1.run(ConnectionGuiHelper.java:142)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.http.NoHttpResponseException: The target server failed to respond</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:101)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:252)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:281)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:247)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:216)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:298)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:647)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:464)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:776)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flushUsingHttpClient(THttpClient.java:235)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 18 more</span></div></div><div><br/></div><ul><li><div>Open Session Error and HTTP Response code 403</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: Knox not allowed to impersonate “hr1” user</span></span></div></li><li><div><span style="list-style: none;">Fix: Perform Pre-configuration #1.3</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-17 18:22:20 INFO  ConnectionMgr.getConnection() Creating new connection for [{Default group}/knox-foo-HS2-krbtgt] for driver=com.simba.hive.jdbc41.HS2Driver and URL=[jdbc:hive2://foo3.openstacklocal:8443/;AuthMech=1;KrbServiceName=HTTP;KrbHostFQDN=foo2.openstacklocal;KrbRealm=</span>FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=gateway/default/hive;SSL=1;SSLTrustStore=/Users/vrathor/Downloads/knox.jks;SSLTrustStorePwd=hadoop;AllowSelfSignedCerts=1<span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-17 18:22:20 ERROR DbDriver.connect() Error connecting to the database using URL=jdbc:hive2://foo3.openstacklocal:8443/;AuthMech=1;KrbServiceName=HTTP;KrbHostFQDN=foo2.openstacklocal;KrbRealm=</span>FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=gateway/default/hive;SSL=1;SSLTrustStore=/Users/vrathor/Downloads/knox.jks;SSLTrustStorePwd=hadoop;AllowSelfSignedCerts=1<span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">, username= [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error. [SQL State=HY000, DB Errorcode=500151]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">java.sql.SQLException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.establishConnection(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.core.LoginTimeoutConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: com.simba.hiveserver2.support.exceptions.GeneralException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 11 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.thrift.transport.TTransportException: HTTP Response code: 403</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flushUsingHttpClient(THttpClient.java:246)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flush(THttpClient.java:297)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:65)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.send_OpenSession(TCLIService.java:153)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.send_OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:145)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.establishConnection(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.core.LoginTimeoutConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.gui.profiles.ConnectionGuiHelper$1.run(ConnectionGuiHelper.java:142)</span></div></div><div><br/></div><ul><li><div>Open Session Error &amp; HTTP Response Code 403 plus Checksum failed in Knox gateway log</div></li><div>
<span style="list-style: none;"><div><ul><li><div><span style="list-style: none;"><span style="list-style: none;">Reason: Hostname mismatch in connection string</span></span></div></li><li><div><span style="list-style: none;">Fix: Use same hostname for KrbHostFQDN</span></div></li></ul></div></span>
</div></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-17 18:45:21 ERROR DbDriver.connect() Error connecting to the database using URL=jdbc:hive2://<b>foo3.openstacklocal</b>:8443/;AuthMech=1;KrbServiceName=HTTP;KrbHostFQDN=<b>foo2.openstacklocal</b>;KrbRealm=</span>FOOBAR.COM;KrbAuthType=2;transportMode=http;httpPath=gateway/default/hive;SSL=1;SSLTrustStore=/Users/vrathor/Downloads/knox.jks;SSLTrustStorePwd=hadoop;AllowSelfSignedCerts=1<span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">, username= [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error. [SQL State=HY000, DB Errorcode=500151]</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">java.sql.SQLException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.establishConnection(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.core.LoginTimeoutConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: com.simba.hiveserver2.support.exceptions.GeneralException: [Simba][HiveJDBCDriver](500151) Error setting/closing session: Open Session Error.</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    ... 12 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.thrift.transport.TTransportException: HTTP Response code: 403</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flushUsingHttpClient(THttpClient.java:246)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.transport.THttpClient.flush(THttpClient.java:297)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:65)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.send_OpenSession(TCLIService.java:153)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.send_OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:145)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2ClientWrapper.OpenSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.openSession(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.HS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ExtendedHS2Client.&lt;init&gt;(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.api.ZooKeeperEnabledExtendedHS2Factory.createClient(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.hivecommon.core.HiveJDBCCommonConnection.establishConnection(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at com.simba.hiveserver2.jdbc.core.LoginTimeoutConnection.connect(Unknown Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.BaseConnectionFactory.doConnect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">com.simba.hiveserver2.jdbc.common.AbstractDriver.connect(Unknown</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Source)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.DbDriver.connect(DbDriver.java:511)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.connect(ConnectionMgr.java:255)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at workbench.db.ConnectionMgr.getConnection(ConnectionMgr.java:182)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector.doConnect(ConnectionSelector.java:227</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    at</span> <a href="http://workbench.gui.components.ConnectionSelector$1.run(ConnectionSelector.java:131" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">workbench.gui.components.ConnectionSelector$1.run(ConnectionSelector.java:131</a><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">)</span></div></div><div><br/></div><div>Knox Gateway Log:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-18 01:45:21,626 TRACE server.KerberosAuthenticationHandler (KerberosAuthenticationHandler.java:run(433)) - Auth HTTP/</span><a href="mailto:foo3.openstacklocal@FOOBAR.COM" style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">foo3.openstacklocal@FOOBAR.COM</a> <span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">failed with GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">2018-08-18 01:45:21,626 DEBUG server.AuthenticationFilter (AuthenticationFilter.java:doFilter(586)) - Authentication exception: org.apache.hadoop.security.authentication.client.AuthenticationException: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">org.apache.hadoop.security.authentication.client.AuthenticationException: org.apache.hadoop.security.authentication.client.AuthenticationException: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler.authenticate(KerberosAuthenticationHandler.java:452)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.AuthenticationFilter.doFilter(AuthenticationFilter.java:540)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayFilter$Holder.doFilter(GatewayFilter.java:332)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayFilter$Chain.doFilter(GatewayFilter.java:232)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.filter.XForwardedHeaderFilter.doFilter(XForwardedHeaderFilter.java:30)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.filter.AbstractGatewayFilter.doFilter(AbstractGatewayFilter.java:61)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayFilter$Holder.doFilter(GatewayFilter.java:332)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayFilter$Chain.doFilter(GatewayFilter.java:232)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayFilter.doFilter(GatewayFilter.java:139)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayFilter.doFilter(GatewayFilter.java:91)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.services.metrics.impl.instr.InstrumentedGatewayFilter.doFilter(InstrumentedGatewayFilter.java:70)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.GatewayServlet.service(GatewayServlet.java:141)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:812)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:587)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.trace.TraceHandler.handle(TraceHandler.java:51)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.gateway.filter.CorrelationHandler.handle(CorrelationHandler.java:39)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.servlets.gzip.GzipHandler.handle(GzipHandler.java:529)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.websocket.server.WebSocketHandler.handle(WebSocketHandler.java:112)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.Server.handle(Server.java:499)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at java.lang.Thread.run(Thread.java:745)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: org.apache.hadoop.security.authentication.client.AuthenticationException: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler$2.run(KerberosAuthenticationHandler.java:444)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler$2.run(KerberosAuthenticationHandler.java:416)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at java.security.AccessController.doPrivileged(Native Method)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at javax.security.auth.Subject.doAs(Subject.java:422)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler.authenticate(KerberosAuthenticationHandler.java:415)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        ... 38 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: GSSException: Failure unspecified at GSS-API level (<b>Mechanism level: Checksum failed</b>)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:856)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler.runWithPrincipal(KerberosAuthenticationHandler.java:477)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler.access$100(KerberosAuthenticationHandler.java:75)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler$2.run(KerberosAuthenticationHandler.java:429)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        ... 42 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: <b>KrbException: Checksum failed</b></span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.internal.crypto.Aes256CtsHmacSha1EType.decrypt(Aes256CtsHmacSha1EType.java:102)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.internal.crypto.Aes256CtsHmacSha1EType.decrypt(Aes256CtsHmacSha1EType.java:94)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.EncryptedData.decrypt(EncryptedData.java:175)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.KrbApReq.authenticate(KrbApReq.java:281)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.KrbApReq.&lt;init&gt;(KrbApReq.java:149)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.jgss.krb5.InitSecContextToken.&lt;init&gt;(InitSecContextToken.java:108)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:829)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        ... 47 more</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">Caused by: java.security.GeneralSecurityException: Checksum failed</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.internal.crypto.dk.AesDkCrypto.decryptCTS(AesDkCrypto.java:451)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.internal.crypto.dk.AesDkCrypto.decrypt(AesDkCrypto.java:272)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.internal.crypto.Aes256.decrypt(Aes256.java:76)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        at sun.security.krb5.internal.crypto.Aes256CtsHmacSha1EType.decrypt(Aes256CtsHmacSha1EType.java:100)</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">        ... 53 more</span></div></div><div><br/></div><ul><li><div>On Windows 10, user getting "Found no TGT's in LSA”:</div></li><ul><li><div>Reason: SQL-Workbench Java application is not able read the Windows credential cache (LSA - Local Security Authority) to get user’s Kerberos ticket (TGT)</div></li><li><div>Fix: Add a new REG_DWORD or edit existing “AllowTGTSessionKey=1” in Windows Registry at HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\Kerberos\Parameters location in Registry Editor</div><div>Need Administrator permission to change this.</div></li></ul></ul><div><img src="Configure%20SQLWorkbench_J%20with%20Knox%20(over%20SSL)%20+%20HiveServer2%20with%20Kerberos%20&amp;%20LDAP_AD%20authentication.resources/VirtualBox_mugdha_06_09_2018_15_24_51.png" height="935" width="1680"/></div><div><br/></div></body></html>